<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <link rel="SHORTCUT ICON" href="http://gulimujyujyu.me/favicon.ico">
        <title>Gulimu Vision -- Issue 2</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="description" content="Fullscreen Gallery with Thumbnail Flip using jQuery" />
        <meta name="keywords" content="jquery, background, full page, fullscreen, image, thumbnail, flip, gallery, slider, slide in, keyboard, key navigation, mousewheel, google font api"/>
        <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/>
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow' rel='stylesheet' type='text/css' />
        <link href='http://fonts.googleapis.com/css?family=Dancing+Script' rel='stylesheet' type='text/css' />
		<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-17034168-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
    </head>
    <body>
        <div id="tf_loading" class="tf_loading">
        </div>
        <div id="tf_bg" class="tf_bg">
            <img src="images/Slide01.png" alt="Image 1" longdesc="images/thumbs/Slide01.png" />
            <img src="images/Slide02.png" alt="Image 1" longdesc="images/thumbs/Slide02.png" />
            <img src="images/Slide03.png" alt="Image 1" longdesc="images/thumbs/Slide03.png" />
            <img src="images/Slide04.png" alt="Image 1" longdesc="images/thumbs/Slide04.png" />
            <img src="images/Slide05.png" alt="Image 1" longdesc="images/thumbs/Slide05.png" />
            <img src="images/Slide06.png" alt="Image 1" longdesc="images/thumbs/Slide06.png" />
            <img src="images/Slide07.png" alt="Image 1" longdesc="images/thumbs/Slide07.png" />
            <img src="images/Slide08.png" alt="Image 1" longdesc="images/thumbs/Slide08.png" />
			      <img src="images/Slide09.png" alt="Image 1" longdesc="images/thumbs/Slide09.png" />
            <img src="images/Slide10.png" alt="Image 1" longdesc="images/thumbs/Slide10.png" />
            <img src="images/Slide11.png" alt="Image 1" longdesc="images/thumbs/Slide11.png" />
            <img src="images/Slide12.png" alt="Image 1" longdesc="images/thumbs/Slide12.png" />
			      <img src="images/Slide13.png" alt="Image 1" longdesc="images/thumbs/Slide13.png" />
            <img src="images/Slide14.png" alt="Image 1" longdesc="images/thumbs/Slide14.png" />
            <img src="images/Slide15.png" alt="Image 1" longdesc="images/thumbs/Slide15.png" />
            <img src="images/Slide16.png" alt="Image 1" longdesc="images/thumbs/Slide16.png" />
			      <img src="images/Slide17.png" alt="Image 1" longdesc="images/thumbs/Slide17.png" />
            <img src="images/Slide18.png" alt="Image 1" longdesc="images/thumbs/Slide18.png" />
            <img src="images/end.jpg" alt="Image 2" longdesc="images/thumbs/end.jpg"/>
            <div class="tf_pattern">
            </div>
        </div>
        <div id="tf_content_wrapper" class="tf_content_wrapper">
            <div class="tf_content" id="content1" style="display:block;">
                <h2>GulimuVision Issue 2</h2>
                <p>
                    GulimuVision is an online journal developed by Gulimujyujyu.me. Its main topic is data visualization. This month I will show the theory of information visualization by <a href="http://www.edwardtufte.com">Edward Tufte</a>, a flash based geovisualizaiton tool provided by <a href="http://ammap.com">amMap</a>, and my demo based on the data of China's sixth census.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>Part I: Data Ink</h2>
                <p>
                   In this part, a theory of data grahics by Edward Tufte will be shown. He uses Data Ink to charaterize the design of graphics with data. All the contents are from his book, The Visual Display of Quantitative Information.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>Data Ink Ratio</h2>
                <p>
                   The data ink ratio is used as the basis of his famous rules on data ink. It is defined as the amount of data ink over the amount of total ink. Therefore, there are two ways to reduce the ratio, remove non-data-ink and redundant data-ink.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>Reducing data ink ratio</h2>
                <p>
                   I use an example from <a href="http://tbray.org">Tim Bray</a>. Suppose we need to redesign the column chart on the left hand side. First, data ink is identified all the necessary information about the 9 points.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>Reducing data ink ratio</h2>
                <p>
                   Then, we may find that the grids, box, background is non-data-ink, while the colomns and the labels show the silimar reads, which implies they are redundant.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>Reducing data ink ratio</h2>
                <p>
                   By applying Rule 1 and Rule 2, finally we obtain the graphics in step 5. Although we can do more clean-up process, some element can be preserved for aethetics purpose.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>Reducing data ink ratio</h2>
                <p>
                   Compare the original graphic with the refined one, it is easy to find that the data ink ratio of the later one is much larger than that of the former one.
                </p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amMap: An interactive map tool</h2>
                <p>amCharts is a small company based in Vilnius, Lithuania. The beginning of amCharts and amMap was in 2004, when the first version of amMap was made.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amMap and amChart</h2>
                <p>They provide two services: amChart and amMap for different purposes. They support many web framework such as Flash, Flex, Javascript, Silverlight.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amMap: Getting started</h2>
                <p>The ammap is mainly used to display static data. It includes a data file, a setting file, a web page, as well as necessary libs and maps.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amMap: Data + setting</h2>
                <p>The data.xml usually stores a map with many areas, whose entry is visualized in the web page. The setting.xml stores the configuration and control policy of the data.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amMap: Customization</h2>
                <p>ammap supports customization by providing a type called move. In this slice, each city is represented as a marker point and lines shows the flight between cities.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amMap: Other features</h2>
                <p>There are many other features, like grouping the countries by setting the same color, drill-down and rolling-up representation, time-line and map of each country.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>amChart: What is more</h2>
                <p>amChart provides a good way to display the data in a web page. It supports pie chart, bar chart, scatter chart, radar chart, line chart, etc. More can be found in <a href="http://amcharts.com">their site</a></p>
            </div>
            <div class="tf_content" id="content2">
                <h2>VisThisMonth</h2>
                <p>The report of 6th census of China is released these days, so I drew them using the amMap, because it provides a good map of provinces of China.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>VisThisMonth: data</h2>
                <p>The data is from 1954 to 2010, provided by the Nation Bureau of Statistics of China. In 1950s, Sichuan has the most people, while in this year, Guangdong ranks first, followed by Shandong and Henan.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>VisThisMonth: density map</h2>
                <p>From the density map, it is interesting that more people live in the east of China and prefer to live in cities. This coincides with the characteristics of economic development of China: labor-intensive and urbanization.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>VisThisMonth: Other statictics</h2>
                <p>It is also worth noting that the birth rate of China decreases every year, which indicates the aging population. In addition, China have done a great job on education to reduce the ratio of illiterate.</p>
            </div>
            <div class="tf_content" id="content2">
                <h2>VisThisMonth: The End</h2>
                <p>
                   You are encouraged to visit my <a href="http://gulimujyujyu.me/web/toyou/dd766493155f0456cfff27fefc6d38fb/vismon.html">page</a> for more details.
                </p>
            </div>
        </div>
        <div id="tf_thumbs" class="tf_thumbs">
            <span id="tf_zoom" class="tf_fullscreen"></span>
            <img src="images/thumbs/1.jpg" alt="Thumb1"/>
        </div>
        <div id="tf_next" class="tf_next">
        </div>
        <div id="tf_prev" class="tf_prev">
        </div>
	<div id="backbutton">
            <span><a href="http://gulimujyujyu.me/web">Back to Gulimujyujyu's Web</a></span>
        </div>
        <div class="description">
            <span>Use keys &uarr; and &darr; or the wheel of the mouse to navigate. <br>Better viewed in widescreen display.</span>
        </div>
        <!-- The JavaScript -->
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js">
        </script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js">
        </script>
        <script type="text/javascript" src="js/jquery.flip.js">
        </script>
        <script type="text/javascript" src="js/jquery-mousewheel-3.0.4/jquery.mousewheel.min.js">
        </script>
        <script type="text/javascript">
            /*
             the images preload plugin
             */
            (function($) {
                $.fn.preload = function(options) {
                    var opts 	= $.extend({}, $.fn.preload.defaults, options);
                    o			= $.meta ? $.extend({}, opts, this.data()) : opts;
                    var c		= this.length,
                    l		= 0;
                    return this.each( function() {
                        var $i	= $(this);
                        $('<img/>').load( function(i) {
                            ++l;
                            if(l == c)
                                o.onComplete();
                        }).attr('src',$i.attr('src'));
                    });
                };
                $.fn.preload.defaults = {
                    onComplete	: function() {
                        return false;
                    }
                };
            })(jQuery);
        </script>
        <script type="text/javascript">
            $( function() {
                var $tf_bg				= $('#tf_bg'),
                $tf_bg_images		= $tf_bg.find('img'),
                $tf_bg_img			= $tf_bg_images.eq(0),
                $tf_thumbs			= $('#tf_thumbs'),
                total				= $tf_bg_images.length,
                current				= 0,
                $tf_content_wrapper	= $('#tf_content_wrapper'),
                $tf_next			= $('#tf_next'),
                $tf_prev			= $('#tf_prev'),
                $tf_loading			= $('#tf_loading');

                //preload the images
                $tf_bg_images.preload({
                    onComplete	: function() {
                        $tf_loading.hide();
                        init();
                    }
                });

                //shows the first image and initializes events
                function init() {
                    //set the returned values and show the image
                    resize($tf_bg_img);
                    $tf_bg_img.show();

                    //resizing the window resizes the $tf_bg_img
                    $(window).bind('resize', function() {
                        resize($tf_bg_img);
                    });
                    //expand and fit the image to the screen
                    $('#tf_zoom').live('click', function() {
                        if($tf_bg_img.is(':animated'))
                            return false;

                        var $this	= $(this);
                        if($this.hasClass('tf_zoom')) {
                            resize($tf_bg_img);
			    $tf_bg_img.fadeIn();
                            $this.addClass('tf_fullscreen')
                            .removeClass('tf_zoom');
                        } else {
                            var dim	= getImageDim($tf_bg_img);
                            $tf_bg_img.animate({
                                width	: dim.width,
                                height	: dim.height,
                                top		: dim.top,
                                left	: dim.left
                            },350);
                            $this.addClass('tf_zoom')
                            .removeClass('tf_fullscreen');
                        }
                    }
                    );

                    //click the arrow down, scrolls down
                    $tf_next.bind('click', function() {
                        if($tf_bg_img.is(':animated'))
                            return false;
                        scroll('tb');
                    });
                    //click the arrow up, scrolls up
                    $tf_prev.bind('click', function() {
                        if($tf_bg_img.is(':animated'))
                            return false;
                        scroll('bt');
                    });
                    //mousewheel events - down / up button trigger the scroll down / up
                    $(document).mousewheel( function(e, delta) {
                        if($tf_bg_img.is(':animated'))
                            return false;

                        if(delta > 0)
                            scroll('bt');
                        else
                            scroll('tb');
                        return false;
                    });
                    //key events - down / up button trigger the scroll down / up
                    $(document).keydown( function(e) {
                        if($tf_bg_img.is(':animated'))
                            return false;

                        switch(e.which) {
                            case 38:
                                scroll('bt');
                                break;

                            case 40:
                                scroll('tb');
                                break;
                        }
                    });
                }

                //show next / prev image
                function scroll(dir) {
                    //if dir is "tb" (top -> bottom) increment current,
                    //else if "bt" decrement it
                    current	= (dir == 'tb')?current + 1:current - 1;

                    //we want a circular slideshow,
                    //so we need to check the limits of current
                    if(current == total)
                        current = 0;
                    else if(current < 0)
                        current = total - 1;

                    //flip the thumb
                    $tf_thumbs.flip({
                        direction	: dir,
                        speed		: 400,
                        onBefore	: function() {
                            //the new thumb is set here
                            var content	= '<span id="tf_zoom" class="tf_fullscreen"></span>';
                            content		+='<img src="' + $tf_bg_images.eq(current).attr('longdesc') + '" alt="Thumb' + (current+1) + '"/>';
                            $tf_thumbs.html(content);
                        }
                    });

                    //we get the next image
                    var $tf_bg_img_next	= $tf_bg_images.eq(current),
                    //its dimentions
                    dim				= getImageDim($tf_bg_img_next),
                    //the top should be one that makes the image out of the viewport
                    //the image should be positioned up or down depending on the direction
                    top	= (dir == 'tb')?$(window).height() + 'px':-parseFloat(dim.height,10) + 'px';

                    //set the returned values and show the next image
                    resize($tf_bg_img_next);
                    $tf_bg_img_next.fadeIn();

                    //now slide it to the viewport
                    //$tf_bg_img_next.stop().animate({
                    //    top 	: dim.top
                    //},1000);

                    //we want the old image to slide in the same direction, out of the viewport
                    var slideTo	= (dir == 'tb')?-$tf_bg_img.height() + 'px':$(window).height() + 'px';
                    $tf_bg_img.stop().animate({
                        top 	: slideTo
                    },1000, function() {
                        //hide it
                        $(this).hide();
                        //the $tf_bg_img is now the shown image
                        $tf_bg_img	= $tf_bg_img_next;
                        //show the description for the new image
                        $tf_content_wrapper.children()
                        .eq(current)
                        .fadeIn();
                    });
                    //hide the current description
                    $tf_content_wrapper.children(':visible')
                    .hide()

                }

                //animate the image to fit in the viewport
                function resize($img) {
                    var w_w	= $(window).width(),
                    w_h	= $(window).height(),
                    i_w	= $img.width(),
                    i_h	= $img.height(),
                    r_i	= i_h / i_w,
                    new_w,new_h;

                    if(i_w > i_h) {
                        new_w	= w_w;
                        new_h	= w_w * r_i;

                        if(new_h > w_h) {
                            new_h	= w_h;
                            new_w	= w_h / r_i;
                        }
                    } else {
                        new_h	= w_w * r_i;
                        new_w	= w_w;
                    }

                    $img.animate({
                        width	: new_w + 'px',
                        height	: new_h + 'px',
                        top		: '0px',
                        left	: '0px'
                    },350);
                }

                //get dimentions of the image,
                //in order to make it full size and centered

                function getImageDim($img) {
                    var w_w	= $(window).width(),
                    w_h	= $(window).height(),
                    r_w	= w_h / w_w,
                    i_w	= $img.width(),
                    i_h	= $img.height(),
                    r_i	= i_h / i_w,
                    new_w,new_h,
                    new_left,new_top;

                    if(r_w > r_i) {
                        new_h	= w_h;
                        new_w	= w_h / r_i;
                    } else {
                        new_h	= w_w * r_i;
                        new_w	= w_w;
                    }

                    return {
                        width	: new_w + 'px',
                        height	: new_h + 'px',
                        left	: (w_w - new_w) / 2 + 'px',
                        top		: (w_h - new_h) / 2 + 'px'
                    };
                }

            });
        </script>
    </body>
</html>
